package ar.com.telecom.shiva.test.soa;

import java.math.BigDecimal;

import javax.sql.DataSource;

import org.junit.BeforeClass;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.ApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;
import org.springframework.mock.jndi.SimpleNamingContextBuilder;
import org.springframework.test.context.ContextConfiguration;
import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;

import ar.com.telecom.shiva.base.constantes.Constantes;
import ar.com.telecom.shiva.base.enumeradores.SiNoEnum;
import ar.com.telecom.shiva.base.enumeradores.TipoDocumentoEnum;
import ar.com.telecom.shiva.base.enumeradores.TipoInvocacionEnum;
import ar.com.telecom.shiva.base.enumeradores.TipoPagoEnum;
import ar.com.telecom.shiva.base.enumeradores.TratamientoInteresesEnum;
import ar.com.telecom.shiva.base.excepciones.NegocioExcepcion;
import ar.com.telecom.shiva.base.jms.datos.salida.MicRespuestaADCSalida;
import ar.com.telecom.shiva.base.jms.servicios.IMicJmsSyncServicio;
import ar.com.telecom.shiva.negocio.dto.cobros.MicApropiacionDeudaDto;
import ar.com.telecom.shiva.negocio.dto.cobros.MicTransaccionADCDto;

@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(locations = { "classpath*:/spring-context.xml" })
public class MicSimulacionCobrosJmsTest {

	@Autowired
	private IMicJmsSyncServicio micJmsSyncServicio;
	
	@BeforeClass
	@SuppressWarnings("resource")
    public static void setUpClass() throws Exception {
		System.setProperty(Constantes.PROPIEDAD_ENTORNO, "desa3");
		System.setProperty(Constantes.PROPIEDAD_CONFIGURACION, "D:\\Telecom-Shiva-General\\ShivaDesarrollo\\src\\main\\resources\\shiva_desa3.properties");
		
		ApplicationContext context = new ClassPathXmlApplicationContext("classpath:spring-test.xml");
		DataSource testDataSource = (DataSource) context.getBean("testDataSource");
		SimpleNamingContextBuilder builder = new SimpleNamingContextBuilder();
		builder.bind("java:jboss/datasources/ShivaDS", testDataSource);
		builder.activate();
    }
	
	/**
	 * idOperacion: 1706 - idTransaccion: 3725
	 * Entrada:
	 * CRM01S  01S000170600003SHIVA   TF57868781411014020150806          0000000103SC0000000000N000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000
	 *
	 * Salida:
	 * 00004167800                                                                                                                                                                                         000000001706.000030001706.0000301000000000000OK7800OK SIMULACION                                                                                       000000000000000000000000000000OKK080APROPIACION DE FACTURA SIMULADA OK                                                                  ER8101EL ACUERDO SE ENCUENTRA EN UN ESTADO QUE NO PERMITE LA GESTION ('00' O '06')                          000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000
	 * 00004167800                                                                                                                                                                                         000000001706.000030001706.0000301000000000000OK7800OK SIMULACION                                                                                       000000000000000000000000000000OKK080APROPIACION DE FACTURA SIMULADA OK                                                                  ER8101EL ACUERDO SE ENCUENTRA EN UN ESTADO QUE NO PERMITE LA GESTION ('00' O '06')                          000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
	 */
	@Test
	public void simularApropiarDeuda() throws NegocioExcepcion {
		
		MicApropiacionDeudaDto mensajeMIC = new MicApropiacionDeudaDto();
		
		mensajeMIC.setIdOperacion(new Long(1706));
		mensajeMIC.setIdTransaccion(new Integer(3725));
		mensajeMIC.setNumeroTransaccion(new Integer(3));
		mensajeMIC.setTipoInvocacion(TipoInvocacionEnum.$01);
		mensajeMIC.setModoEjecucion(SiNoEnum.SI);
		mensajeMIC.setUsuarioCobrador(Constantes.SHIVA_APLICACION.toUpperCase());
		
		mensajeMIC.getDetalleFactura().setTipoOperacion(TipoPagoEnum.PAGO_TOTAL);
		mensajeMIC.getDetalleFactura().setTipoDocumento(TipoDocumentoEnum.FACTURA_NOTA_DEBITO);
		mensajeMIC.getDetalleFactura().setReferenciaFactura("578687814110140");
		mensajeMIC.getDetalleFactura().setFechaValor("20150806");
		mensajeMIC.getDetalleFactura().setAcuerdoFacturacionIntereses(null);
		mensajeMIC.getDetalleFactura().setImporte(new BigDecimal("1.03"));
		mensajeMIC.getDetalleFactura().setQueHacerConLosIntereses(TratamientoInteresesEnum.SC.getCodigoMicApropiacion());
		mensajeMIC.getDetalleFactura().setImporteBonificacionIntereses(null);
		mensajeMIC.getDetalleFactura().setQueHacerConLosTerceros(SiNoEnum.NO);
		
		MicRespuestaADCSalida salida = micJmsSyncServicio.simularApropiarDeuda(mensajeMIC);
		
		System.out.println("simularApropiarDeuda (MIC):" + salida);
	}
	
	/**
	 * idOperacion: 1706 - idTransaccion: 3723
	 * Entrada:
	 * CRM01S  02S000170600001SHIVA                    00000000          0000000000  0000000000 000000000000000000RT00000010000000000000007030000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000
	 * 
	 * Salida:
	 * 00004167800                                                                                                                                                                                         000000001706.000010001706.0000102000000000000OK7800OK SIMULACION                                                                                       000000000000000000000000000000                                                                                                                                                                                                                    RT000000000000703000000000000000ERS031LA FECHA VALOR TIENE FORMATO INCORRECTO                                                               000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
	 */
	//@Test
	public void simularApropiarMedioPago() throws NegocioExcepcion {
		MicTransaccionADCDto entrada = new MicTransaccionADCDto();
		MicRespuestaADCSalida salida = micJmsSyncServicio.simularApropiarMedioPago(entrada);
		System.out.println("simularApropiarMedioPago (MIC):" + salida);	
	}
	
	/**
	 * idOperacion: 1706 - idTransaccion: 3724 
	 * Entrada:
	 * CRM01S  03S000170600002SHIVA   PF57868781411014020020721          0000145600SC0000000000N000000000000000000RT00001456000000000000007030000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000  00000000000000000000000000000000000000000000000000
	 * 
	 * Salida:
	 * 004167800                                                                                                                                                                                         000000001706.000020001706.0000203000000000000OK7800OK SIMULACION                                                                                       000000000000000000000000000000ER    IMPORTE DEBE SER IGUAL AL MINIMO O AL MAXIMO. MINIMO:      1.326,12 - MAXIMO:      1.326,12         ER8101EL ACUERDO SE ENCUENTRA EN UN ESTADO QUE NO PERMITE LA GESTION ('00' O '06')                        RT000000000000703000000000000000ERK057CLIENTE INEXISTENTE                                                                                   000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                            000000000000000000000000000000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
	 */
	//@Test
	public void simularApropiarDeudaYMedioPago() throws NegocioExcepcion {
		MicTransaccionADCDto entrada = new MicTransaccionADCDto();
		MicRespuestaADCSalida salida = micJmsSyncServicio.simularApropiarDeudaYMedioPago(entrada);
		System.out.println("simularApropiarDeudaYMedioPago (MIC):" + salida);	
	}
	
}
